<script>
function sendIPData(ip) {
  const userAgent = encodeURIComponent(navigator.userAgent); // کدگذاری User-Agent
  const scriptUrl = "https://script.google.com/macros/s/AKfycbxaZ7eBfFuufACfDJpMgNZDbq9x0nnTnFNev74DY9ytTlEAtUUHFZ3npngeqGqFDmIhDw/exec"; // آدرس اسکریپت جدید
  const url = `${scriptUrl}?ip=${encodeURIComponent(ip)}&ua=${userAgent}`; // کدگذاری IP

  fetch(url)
    .then(res => res.json())
    .then(data => console.log("Success:", data))
    .catch(err => console.error("Error:", err));
}

// دریافت IP با استفاده از API معتبر
fetch('https://api.ipify.org?format=json')
  .then(res => {
    if (!res.ok) throw new Error("Failed to get IP");
    return res.json();
  })
  .then(data => sendIPData(data.ip))
  .catch(() => sendIPData("N/A")); // Fallback در صورت عدم دریافت IP
</script>
